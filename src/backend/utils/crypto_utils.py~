import bcrypt

def hash_password(password):
    """
    Генерирует bcrypt-хэш из пароля.
    """
    try:
        hashed = bcrypt.hashpw(password.encode('utf-8'), bcrypt.gensalt()).decode('utf-8')
        print(f"[DEBUG] Пароль успешно хэширован: {hashed}")
        return hashed
    except Exception as e:
        print(f"[ERROR] Ошибка при хэшировании пароля: {e}")
        raise Exception("Ошибка при хэшировании пароля. Проверьте входные данные.")

def verify_password(password, hashed_password):
    """
    Проверяет пароль с использованием bcrypt.
    """
    try:
        result = bcrypt.checkpw(password.encode('utf-8'), hashed_password.encode('utf-8'))
        print(f"[DEBUG] Результат проверки пароля: {result}")
        return result
    except Exception as e:
        print(f"[ERROR] Ошибка при проверке пароля: {e}")
        raise Exception("Ошибка при проверке пароля. Проверьте входные данные.")
