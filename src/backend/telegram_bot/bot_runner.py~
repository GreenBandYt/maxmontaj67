import os
import sys

# Настраиваем sys.path на папку telegram_bot
telegram_bot_root = os.path.abspath(os.path.dirname(__file__))
if telegram_bot_root not in sys.path:
    sys.path.insert(0, telegram_bot_root)

from handlers.registration import register_all_handlers
from bot_utils.bot_config import BOT_DB_CONFIG
from telegram.ext import ApplicationBuilder

def run_bot():
    """
    Запуск Telegram-бота.
    """
    # Проверяем наличие токена
    from bot_token import TELEGRAM_BOT_TOKEN
    if not TELEGRAM_BOT_TOKEN:
        raise ValueError("Токен Telegram не указан!")

    # Создаем приложение Telegram
    application = ApplicationBuilder().token(TELEGRAM_BOT_TOKEN).build()

    # Регистрируем обработчики
    register_all_handlers(application)

    print("Telegram-бот запущен. Ожидание сообщений...")
    application.run_polling()

if __name__ == "__main__":
    run_bot()
